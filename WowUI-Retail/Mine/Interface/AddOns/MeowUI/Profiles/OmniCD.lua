local E = unpack(ElvUI)
local _G = _G
local IsAddOnLoaded = _G.C_AddOns and _G.C_AddOns.IsAddOnLoaded or _G.IsAddOnLoaded
local MeowUI = E:GetModule("MeowUI")
local OmniCDProfile

--handle the omnicd string
function MeowUI:HandleOmniCDString(data)
	local D = E:GetModule('Distributor')
	local LibDeflate = E.Libs.Deflate
	local decodedData = LibDeflate:DecodeForPrint(data)
	local decompressed = LibDeflate:DecompressDeflate(decodedData)
	local serializedData = format('%s%s', decompressed, '^^')
	local success,profileData = D:Deserialize(serializedData)
	if success then
		return profileData
	end
end

-- OmniCD profile setup
function MeowUI:GetOmniCDProfile(profile)
	if IsAddOnLoaded("OmniCD") and E.Retail then

		if profile == "C1" then
			OmniCDProfile = "9zvBVTnom4)q3g07V8XlPT7kWAAbCkUB3hmGAIsJrDSdSvAxh2p(JKsoj9wxtrQziPiF0dPOCnVEzD1xIDXHqlkUPVlnIcHUvB7hivTHhRRU9(LF96fxwNQR63NA67ExtJPq6W4SWhTWQDH223Zo4rk(90HHiHG3eRzFPU6NZVc(yLm2nX(x(RdXFoux9ay)DTKYr8UWq6vmc7NeGumeGWsjzi0SgKjAOTF1tX11ZQbe2Di0Ex)V4YR1xP8sMYQCcVuOLCr9MpPu1vFV(kNsAfcJ2QKsdJXqlYmkoUx(7M1PT1leEpQUeAbTD32)YIWUy9dVF(fL8R5EjhYUgsg8pZP8R8CN1PfEHr4SshArKZ)(W61nDp(p1laxhxfAJaC5EJwZLcUJRKmCJOLaleET)aSeO638dOBa6lQ6aCHfIz5O9lWB(fLYeGpd3y5cRZRymltrSGHWNvlygLrYKgNs5oYpvnDP4WWH9PtrXXLEV2OnmT2dFoTlTAUYiGuW1cNu8gwEFSTLaLrkX6OWj00toOGJmRKBmKGq4ykpAKZvmUJ0zmwlPdYHNr(lD(S)gPr5Y2yAbQc4pdfaPqz8KtmbxsHIZ1wnfbUq5TkAHkNIIPX5TKnbyuxaHx7eewLAbNIM2rHxWSM8c5mNIt6G8zO8OHutX0YzYmQ0wVJvWa3MriQJ2ggO3a1aqYqURysxXjVoJtUxW0zcbkHatIX3d9u5mPTcUkB1c16C216Cq8(cZyZukazbK5zOpqrNK4wpttRtz1gItfgLvsLkLNu4mEvHsnqFDoakzUciDW5oA7WDkJPqBCNxtGri0mBMuXgTmGKAjJ05mWgUqfLYodokrgHyOjbGbzzBqNSQemLwNzaUxPZvuTi3OXfmfbdPW7uui0oFUQrdlYqei2mN7HPhfQwK7cbBL2jhxiosD5Mqg0PNROEPR0hlKzBAhCwi3NanFLYHd7JZTaso6hEkBvFhD4yv)b8axfngyb7ZwnOBBy4Xyrf)ZI88OL99TPM9y0xhhHrydHu8pxLAEoI6gNIa0fKMMeuHPaNqXZPDF)yZ09fHukSA7n9dryI(TlxE7nF9YRwE(4j(Kt)phG7eIhN8mD70VgOdBQRUS957VgUSzZgyjqiz4Y((Id7UMiGfaBnD72BwBEbFdgr6HRvgIHNURhMmD24PJa9BiqHFUzahydRDDZyyyhmx)i7oFE(xRWh440Mh32cFtO7p22)YSdB2S8195766tBJ44viIX46(DO4qyvdSxbP44ySBfr5PHMUNaMygMONJDHosEBm75oq3UywhSFIDJLsfwBU5mJNqzzM((HgyGF(gYuamse3eCq5cEqXPTlig6J4wfK2)8(j0v8bghtIijapA2T7qhMIfw(5Sk5DCcSlGtXVfUODAdsLYZ1MPns64MDbNXYb4ItXuQWDv3tNPsZEtTILPHU(U4)cFRIPeuONETbOvh4AGIEpBHbWgvwp9Eu4PN7GRsJ5lnpD47ThRstNBqtF41QWawycMsQXz6LR9kV2bhUutBGRBmWGv15xi(7bey85MXMhAAl1CCJNHkuhrf)we)Hrf)R(2DDnZVqaVM3FGVp29x)P585I)7d"
		elseif profile == "C2" then
			OmniCDProfile = "9zvBVTnom4)q3g07V8XlPT7kWAAbCkUB3hmGAIsJrDSdSvAxh2p(JKsoj9wxtrQziPiF0dPOCnVEzD1xIDXHqlkUPVlnIcHUvB7hivTHhRRU9(LF96fxwNQR63NA67ExtJPq6W4SWhTWQDH223Zo4rk(90HHiHG3eRzFPU6NZVc(yLm2nX(x(RdXFoux9ay)DTKYr8UWq6vmc7NeGumeGWsjzi0SgKjAOTF1tX11ZQbe2Di0Ex)V4YR1xP8sMYQCcVuOLCr9MpPu1vFV(kNsAfcJ2QKsdJXqlYmkoUx(7M1PT1leEpQUeAbTD32)YIWUy9dVF(fL8R5EjhYUgsg8pZP8R8CN1PfEHr4SshArKZ)(W61nDp(p1laxhxfAJaC5EJwZLcUJRKmCJOLaleET)aSeO638dOBa6lQ6aCHfIz5O9lWB(fLYeGpd3y5cRZRymltrSGHWNvlygLrYKgNs5oYpvnDP4WWH9PtrXXLEV2OnmT2dFoTlTAUYiGuW1cNu8gwEFSTLaLrkX6OWj00toOGJmRKBmKGq4ykpAKZvmUJ0zmwlPdYHNr(lD(S)gPr5Y2yAbQc4pdfaPqz8KtmbxsHIZ1wnfbUq5TkAHkNIIPX5TKnbyuxaHx7eewLAbNIM2rHxWSM8c5mNIt6G8zO8OHutX0YzYmQ0wVJvWa3MriQJ2ggO3a1aqYqURysxXjVoJtUxW0zcbkHatIX3d9u5mPTcUkB1c16C216Cq8(cZyZukazbK5zOpqrNK4wpttRtz1gItfgLvsLkLNu4mEvHsnqFDoakzUciDW5oA7WDkJPqBCNxtGri0mBMuXgTmGKAjJ05mWgUqfLYodokrgHyOjbGbzzBqNSQemLwNzaUxPZvuTi3OXfmfbdPW7uui0oFUQrdlYqei2mN7HPhfQwK7cbBL2jhxiosD5Mqg0PNROEPR0hlKzBAhCwi3NanFLYHd7JZTaso6hEkBvFhD4yv)b8axfngyb7ZwnOBBy4Xyrf)ZI88OL99TPM9y0xhhHrydHu8pxLAEoI6gNIa0fKMMeuHPaNqXZPDF)yZ09fHukSA7n9dryI(TlxE7nF9YRwE(4j(Kt)phG7eIhN8mD70VgOdBQRUS957VgUSzZgyjqiz4Y((Id7UMiGfaBnD72BwBEbFdgr6HRvgIHNURhMmD24PJa9BiqHFUzahydRDDZyyyhmx)i7oFE(xRWh440Mh32cFtO7p22)YSdB2S8195766tBJ44viIX46(DO4qyvdSxbP44ySBfr5PHMUNaMygMONJDHosEBm75oq3UywhSFIDJLsfwBU5mJNqzzM((HgyGF(gYuamse3eCq5cEqXPTlig6J4wfK2)8(j0v8bghtIijapA2T7qhMIfw(5Sk5DCcSlGtXVfUODAdsLYZ1MPns64MDbNXYb4ItXuQWDv3tNPsZEtTILPHU(U4)cFRIPeuONETbOvh4AGIEpBHbWgvwp9Eu4PN7GRsJ5lnpD47ThRstNBqtF41QWawycMsQXz6LR9kV2bhUutBGRBmWGv15xi(7bey85MXMhAAl1CCJNHkuhrf)we)Hrf)R(2DDnZVqaVM3FGVp29x)P585I)7d"
		elseif profile == "L1" then
			OmniCDProfile = "9zvBpTrsm4)qxRMXZ7F8cuOirdOBbDxVpSsdjtiRyZUr7obkN6p(Z2ZMxqLcv0yS9y)4h7XtQL13vxDzQlneBjXv9D5rsi2TyD)aRQn(yD1n3F31xn)l156Q(T5M(U310yoM3nol(rhSAtST99SJEKt)iVBiXi4nXA2L1v)8SlWFCkH4BP(x(6U0phQREaT)UwYLiEBCi)kfHT7fWumeXWYjzi2SeLzAOTFXtPL1ZQre2Tl2EB)V4YR1xOdkH2P9qqbgLeQx9jTUU6h1x41khawJtRuwHqqwufuCOw(7ML511ZHqGupfAGl319VmpUjv)W7NFyk)gzqjXSBWKH)N9y(1bP35nqaSG3P8KfOK)TXLlB6E8FQNJUoUi2Mq4kdwJrQaPxQvcQqmkKfIV2Vdpc29B(pCAaNlQ6qCrnIzLO9lW7SZNAti(SsRtcoFqleoHMzblJpNbewTvjuwVw7pWpvnD50WWUT5JrXlvHGXAScJjG)CSkDgP2cykKgWRG3WYBtTTmOSkf1hbpy4pLOcjXSkP1Yca4f6azuk1cPN1zTohRdZrqW(R8HI)wLv7l2egGuH8NLdGc02a7KaKQsOey7rWwbDWP5dQ9AoMwFWXrhqJMjqemEGXQYasoAgphEq4SLdkfETK1H5ZY5XGPMJjagHJJKXf8C0LsJ0zpOJldloBqAqiz5Iqlu(jNcMcoLbqyMQcHdzsk(bCMQKjJdK6Ivh2RzDoJPeKqyIzCfkfHmGzEg5d20zjPlim850oJL5uWQDkUvPdScVnONOuloxxcGwv6amnZbq61w7eTj9bddgpERuwiaAqJPjduMiKElwVtmrbI4bnCNcPnrPSXXxTBA2WySLsszuSBkzqBkefi0CYn(qPdPfbCVa7fGQy)5LffiIelNrbo5wcka7hcnotXigHYCLYjfk4alYw9sakGguf3nE8UW0iKQ0KrQMMJlJakj5hDlBrFhF5yr)o6cxfVgyU4ZodQBDC4X0Kk5NHY(O767BZnBPOVmnIRWgI50FUi38CI0nUpc4uqE)MGkkf0gkzjTB7hB2)EXI(2DBqqmhX0j7KK4Zn5CCX66Q7U52R)Yf06A8vGu(ef9RwHkqVD4s)Hu8PB7X9gNS84WBw0z(RRU8Rho03RNJ3(R2TQU6lTpF)vhY93PCJhC1aT4f9FzZyCydUF(alD2zL)Ab9bTwS5X1T4VzY9hB7Fz2UvRU71TL3S6ZRt0AsmIP0Y(nK4qCrdUefLsJJPUfm1LhA6EcRVzuIEo1f7y51PINBqDBsfDynK6gNOCIJ)2jgpIYPDZBhAWf3Lx6Yr0i2FochsEcpK4(YffJ9jQuP(YZB3JUjFW1QSirc4hnB2SRJsXCN8u(N9oThSZXBJVfUKDUajHnNQTqBS0HIfNreLaC(XyQ0uv190jQmI30RefAORVl9V4VvPCgB07F(hhzrUgPO3ZwCaTXT1JFFi6wWT4tIPYJFhVe92Rh59Z)KPp85rCrjUhrRm0U5PNVM(6ds8XjJfxdyXfK6tFy73di04ZnJnp00o1ZPcVavSpsk(Ti(dJk9V6B201C25a(11(d67vD)vF6A51W)d"
		elseif profile == "L2" then
			OmniCDProfile = "9zvBpTrsm4)qxRMXZ7F8cuOirdOBbDxVpSsdjtiRyZUr7obkN6p(Z2ZMxqLcv0yS9y)4h7XtQL13vxDzQlneBjXv9D5rsi2TyD)aRQn(yD1n3F31xn)l156Q(T5M(U310yoM3nol(rhSAtST99SJEKt)iVBiXi4nXA2L1v)8SlWFCkH4BP(x(6U0phQREaT)UwYLiEBCi)kfHT7fWumeXWYjzi2SeLzAOTFXtPL1ZQre2Tl2EB)V4YR1xOdkH2P9qqbgLeQx9jTUU6h1x41khawJtRuwHqqwufuCOw(7ML511ZHqGupfAGl319VmpUjv)W7NFyk)gzqjXSBWKH)N9y(1bP35nqaSG3P8KfOK)TXLlB6E8FQNJUoUi2Mq4kdwJrQaPxQvcQqmkKfIV2Vdpc29B(pCAaNlQ6qCrnIzLO9lW7SZNAti(SsRtcoFqleoHMzblJpNbewTvjuwVw7pWpvnD50WWUT5JrXlvHGXAScJjG)CSkDgP2cykKgWRG3WYBtTTmOSkf1hbpy4pLOcjXSkP1Yca4f6azuk1cPN1zTohRdZrqW(R8HI)wLv7l2egGuH8NLdGc02a7KaKQsOey7rWwbDWP5dQ9AoMwFWXrhqJMjqemEGXQYasoAgphEq4SLdkfETK1H5ZY5XGPMJjagHJJKXf8C0LsJ0zpOJldloBqAqiz5Iqlu(jNcMcoLbqyMQcHdzsk(bCMQKjJdK6Ivh2RzDoJPeKqyIzCfkfHmGzEg5d20zjPlim850oJL5uWQDkUvPdScVnONOuloxxcGwv6amnZbq61w7eTj9bddgpERuwiaAqJPjduMiKElwVtmrbI4bnCNcPnrPSXXxTBA2WySLsszuSBkzqBkefi0CYn(qPdPfbCVa7fGQy)5LffiIelNrbo5wcka7hcnotXigHYCLYjfk4alYw9sakGguf3nE8UW0iKQ0KrQMMJlJakj5hDlBrFhF5yr)o6cxfVgyU4ZodQBDC4X0Kk5NHY(O767BZnBPOVmnIRWgI50FUi38CI0nUpc4uqE)MGkkf0gkzjTB7hB2)EXI(2DBqqmhX0j7KK4Zn5CCX66Q7U52R)Yf06A8vGu(ef9RwHkqVD4s)Hu8PB7X9gNS84WBw0z(RRU8Rho03RNJ3(R2TQU6lTpF)vhY93PCJhC1aT4f9FzZyCydUF(alD2zL)Ab9bTwS5X1T4VzY9hB7Fz2UvRU71TL3S6ZRt0AsmIP0Y(nK4qCrdUefLsJJPUfm1LhA6EcRVzuIEo1f7y51PINBqDBsfDynK6gNOCIJ)2jgpIYPDZBhAWf3Lx6Yr0i2FochsEcpK4(YffJ9jQuP(YZB3JUjFW1QSirc4hnB2SRJsXCN8u(N9oThSZXBJVfUKDUajHnNQTqBS0HIfNreLaC(XyQ0uv190jQmI30RefAORVl9V4VvPCgB07F(hhzrUgPO3ZwCaTXT1JFFi6wWT4tIPYJFhVe92Rh59Z)KPp85rCrjUhrRm0U5PNVM(6ds8XjJfxdyXfK6tFy73di04ZnJnp00o1ZPcVavSpsk(Ti(dJk9V6B201C25a(11(d67vD)vF6A51W)d"
		elseif profile == "R1" then
			OmniCDProfile = "9z12UTnsm0FOTfZ9lpUoPPBa26guLIDBFqatThhlezjdPXjnl6h)Yls(cAAtGJziPip8qoCuTS((6Q3N7YdPwuCtFxzefsDR22pqQAtpux9XpF)FF7Y3vxQR63xA67EvtJLu5W4I0V7bR2LABFn7GhL83lhgYecUiwlEFD1pU6g4hVwi(qU)5)6q(hd1vFdS)QwkCeVlnuEbJW(zbifdjiSusgsnRbzIgA7x9yED9IAaHDhsT31)tU8s9nMOwy8MGkQvwTuvV5ngtD13RVjy0ELYz9gT2jec0IMrXXA5FAwx2wVufJO6PqROYDB)Zlt7Y1F71ZVAk)wzulHSBHKb)XDk)MOm4dwvu5ubVoGwuC(3NwVUP7H)TEj464QuBgGRm6SwPwjdsJwGfIvdSq6L(dWJaD)M)dMgG5IQoaxyJybhTlGxtxjpmCyFzQt9cgzDmADwNWAJWpNGO3knoLxQKwvqRosrurE11NcHt6aV8HOri8cd5OBkekHZ40cTlymHly5952wcuoTg7JQGYsFlbfsKz1sNJeuQGWerJsPridKoNZ7jDamJcYFDiY(70otGTjSkufWFokaALXfjNekPMdLaApcYQYe9g6bnbdftxi6PORaJ2jqeTbfHvTvjPOzdu4vcVJFqPiyKKoiFokpwi1um9sHMrL1hdu0LsR0Zie1rLHdMnqnaKCK7gHom5u0Y4ugvc7uvi8atIXpcZuCMSEL0Ww9qxIZU1YbjgNygptPaKvqMxG(aTlss6Jcl9CgV1rCQYz8AQvzIKIGlAMOuhmxZbWO5oarZuaKbJZnrBYq0sGjaNkLmbgNiojoRWitB1CFj4GkFItyWcHWs2acuWeamcA8ttjwltaYOXYnuRINZKkHHqHreH9ceAvqUPGrllyiceltMQ5rNOsnpfA9wXrkJ9tahsy8h1C)livkgekn7Jnahu4mQSc)evJZX8iGwI(bNoAw13rhow1FapZwrRbwkER3c62MgEipPs(wfVp6(((2sZEmMRZJWkSHuj)NRknpLrDJZraMcoEgUctbUHsYPDF)yZ89fh2ux9U2N(8TWDbB2mMlWcj)5BNKWc9HC6X76H1kNTBz2)VuVeohdvq7HDqXSeQT5N(l4tdoUzaxIcjBDZyAyhSR9yfF1v8)Tc)cxX18W2w4tbD)H2(NxCyZM7FzpF)tFzBgx5brmNx3VdfhsRAGfIGuECm3TIOHYqt3J5ckUQ)PCxQJK3Mzp3b62LzDqvK7gNOpKV(WzgpHYP9S7hAGLW8TwLeye46tWbLNWdkoxUGyQpJLkYnpTFgDt(aRijrKeGVA2T7qhMILE558n5DEgSlHtwxcx0ovGOWUZ1Y0gjDSyH(KGdW1NIP2Gvv3JNPYkUOxjyAORVl)v4tvUuGg98v5W4hW1af9A2sdGnQTE6DBWj67GR3Y8fzNoqC5OEzEwgn9t3eF(LuWspyzIrBX9St3Mn9Qas4IgRdor7GLDMZVK6xdiW4tnJnFRPDQNJfodvOps31(Rq8VnQ4V1FCxxZvxRGx96pW3r6Z3(Mpj)K6))"
		elseif profile == "R2" then
			OmniCDProfile = "9z12UTnsm0FOTfZ9lpUoPPBa26guLIDBFqatThhlezjdPXjnl6h)Yls(cAAtGJziPip8qoCuTS((6Q3N7YdPwuCtFxzefsDR22pqQAtpux9XpF)FF7Y3vxQR63xA67EvtJLu5W4I0V7bR2LABFn7GhL83lhgYecUiwlEFD1pU6g4hVwi(qU)5)6q(hd1vFdS)QwkCeVlnuEbJW(zbifdjiSusgsnRbzIgA7x9yED9IAaHDhsT31)tU8s9nMOwy8MGkQvwTuvV5ngtD13RVjy0ELYz9gT2jec0IMrXXA5FAwx2wVufJO6PqROYDB)Zlt7Y1F71ZVAk)wzulHSBHKb)XDk)MOm4dwvu5ubVoGwuC(3NwVUP7H)TEj464QuBgGRm6SwPwjdsJwGfIvdSq6L(dWJaD)M)dMgG5IQoaxyJybhTlGxtxjpmCyFzQt9cgzDmADwNWAJWpNGO3knoLxQKwvqRosrurE11NcHt6aV8HOri8cd5OBkekHZ40cTlymHly5952wcuoTg7JQGYsFlbfsKz1sNJeuQGWerJsPridKoNZ7jDamJcYFDiY(70otGTjSkufWFokaALXfjNekPMdLaApcYQYe9g6bnbdftxi6PORaJ2jqeTbfHvTvjPOzdu4vcVJFqPiyKKoiFokpwi1um9sHMrL1hdu0LsR0Zie1rLHdMnqnaKCK7gHom5u0Y4ugvc7uvi8atIXpcZuCMSEL0Ww9qxIZU1YbjgNygptPaKvqMxG(aTlss6Jcl9CgV1rCQYz8AQvzIKIGlAMOuhmxZbWO5oarZuaKbJZnrBYq0sGjaNkLmbgNiojoRWitB1CFj4GkFItyWcHWs2acuWeamcA8ttjwltaYOXYnuRINZKkHHqHreH9ceAvqUPGrllyiceltMQ5rNOsnpfA9wXrkJ9tahsy8h1C)livkgekn7Jnahu4mQSc)evJZX8iGwI(bNoAw13rhow1FapZwrRbwkER3c62MgEipPs(wfVp6(((2sZEmMRZJWkSHuj)NRknpLrDJZraMcoEgUctbUHsYPDF)yZ89fh2ux9U2N(8TWDbB2mMlWcj)5BNKWc9HC6X76H1kNTBz2)VuVeohdvq7HDqXSeQT5N(l4tdoUzaxIcjBDZyAyhSR9yfF1v8)Tc)cxX18W2w4tbD)H2(NxCyZM7FzpF)tFzBgx5brmNx3VdfhsRAGfIGuECm3TIOHYqt3J5ckUQ)PCxQJK3Mzp3b62LzDqvK7gNOpKV(WzgpHYP9S7hAGLW8TwLeye46tWbLNWdkoxUGyQpJLkYnpTFgDt(aRijrKeGVA2T7qhMILE558n5DEgSlHtwxcx0ovGOWUZ1Y0gjDSyH(KGdW1NIP2Gvv3JNPYkUOxjyAORVl)v4tvUuGg98v5W4hW1af9A2sdGnQTE6DBWj67GR3Y8fzNoqC5OEzEwgn9t3eF(LuWspyzIrBX9St3Mn9Qas4IgRdor7GLDMZVK6xdiW4tnJnFRPDQNJfodvOps31(Rq8VnQ4V1FCxxZvxRGx96pW3r6Z3(Mpj)K6))"
		end

		local profileData = MeowUI:HandleOmniCDString(OmniCDProfile)
		if profileData then
			if profile == "C1" then
				OmniCDDB["profiles"]["MeowUI C1"] = {}
				OmniCDDB["profiles"]["MeowUI C1"] = profileData
				OmniCDDB["profileKeys"][E.mynameRealm] = "MeowUI C1"
			elseif profile == "C2" then
				OmniCDDB["profiles"]["MeowUI C2"] = {}
				OmniCDDB["profiles"]["MeowUI C2"] = profileData
				OmniCDDB["profileKeys"][E.mynameRealm] = "MeowUI C2"
			elseif profile == "L1" then
				OmniCDDB["profiles"]["MeowUI L1"] = {}
				OmniCDDB["profiles"]["MeowUI L1"] = profileData
				OmniCDDB["profileKeys"][E.mynameRealm] = "MeowUI L1"
			elseif profile == "L2" then
				OmniCDDB["profiles"]["MeowUI L2"] = {}
				OmniCDDB["profiles"]["MeowUI L2"] = profileData
				OmniCDDB["profileKeys"][E.mynameRealm] = "MeowUI L2"
			elseif profile == "R1" then
				OmniCDDB["profiles"]["MeowUI R1"] = {}
				OmniCDDB["profiles"]["MeowUI R1"] = profileData
				OmniCDDB["profileKeys"][E.mynameRealm] = "MeowUI R1"
			elseif profile == "R2" then
				OmniCDDB["profiles"]["MeowUI R2"] = {}
				OmniCDDB["profiles"]["MeowUI R2"] = profileData
				OmniCDDB["profileKeys"][E.mynameRealm] = "MeowUI R2"
			end
			print("OmniCD profile "..profile.." imported.")
		else
			print("Error importing OmniCD profile in MeowUI.")
		end
	end
end
